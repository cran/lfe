
R Under development (unstable) (2014-10-08 r66730) -- "Unsuffered Consequences"
Copyright (C) 2014 The R Foundation for Statistical Computing
Platform: x86_64-unknown-linux-gnu (64-bit)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

> library(lfe)
Loading required package: Matrix
> options(lfe.threads=2,digits=4,warn=1)
> set.seed(42)
> x <- rnorm(5000,mean=2)
> x2 <- rnorm(length(x))
> x3 <- rexp(length(x))
> #ix <- rep(2.0,length(x))
> ## create individual and firm
> id <- factor(sample(150,length(x),replace=TRUE))
> ix <- matrix(rnorm(2*length(x)),length(x),2)*sqrt(as.numeric(id)/nlevels(id))
> colnames(ix) <- c('col1','col2')
> firm <- factor(sample(130,length(x),replace=TRUE))
> fx <- rnorm(length(x))*sqrt(as.numeric(id)/nlevels(firm))
> shoe <- factor(sample(10,length(x),replace=TRUE))
> shirt <- factor(sample(10,length(x),replace=TRUE))
> ## effects
> id.eff <- rnorm(nlevels(id))
> firm.eff <- rnorm(nlevels(firm))
> shoe.eff <- rnorm(nlevels(shoe))
> shirt.eff <- rnorm(nlevels(shirt))
> ## left hand side
> y <- x + 0.25*x2 + 0.5*x3 + rowSums(ix*id.eff[id]) + id.eff[id] + fx*firm.eff[firm] + firm.eff[firm] + shoe.eff[shoe] + shirt.eff[shirt] + rnorm(length(x))
> 
> ## estimate
> summary(est <- felm(y ~ x+x2+x3 | ix:id+id+fx:firm+firm+shoe+shirt, exactDOF=T))

Call:
   felm(formula = y ~ x + x2 + x3 | ix:id + id + fx:firm + firm +      shoe + shirt, exactDOF = T) 

Residuals:
    Min      1Q  Median      3Q     Max 
-3.5245 -0.6302 -0.0125  0.6284  3.5420 

Coefficients:
   Estimate Std. Error t value Pr(>|t|)    
x    0.9975     0.0153    65.3   <2e-16 ***
x2   0.2636     0.0152    17.3   <2e-16 ***
x3   0.4956     0.0149    33.3   <2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1 on 4270 degrees of freedom
Multiple R-squared: 0.898   Adjusted R-squared: 0.881 
F-statistic:51.7 on 729 and 4270 DF, p-value: <2e-16 


> getfe(est)
                 effect obs comp        fe idx
ixcol1:id.1    1.668888  43    0 ixcol1:id   1
ixcol1:id.2    1.789684  26    0 ixcol1:id   2
ixcol1:id.3    1.277047  41    0 ixcol1:id   3
ixcol1:id.4    0.775110  34    0 ixcol1:id   4
ixcol1:id.5   -0.802002  32    0 ixcol1:id   5
ixcol1:id.6   -2.414784  33    0 ixcol1:id   6
ixcol1:id.7    2.724663  31    0 ixcol1:id   7
ixcol1:id.8   -1.262937  37    0 ixcol1:id   8
ixcol1:id.9    0.143217  42    0 ixcol1:id   9
ixcol1:id.10   2.151658  32    0 ixcol1:id  10
ixcol1:id.11   0.580303  29    0 ixcol1:id  11
ixcol1:id.12   1.372324  43    0 ixcol1:id  12
ixcol1:id.13  -0.249873  34    0 ixcol1:id  13
ixcol1:id.14   0.040892  33    0 ixcol1:id  14
ixcol1:id.15   2.760919  34    0 ixcol1:id  15
ixcol1:id.16  -1.030672  27    0 ixcol1:id  16
ixcol1:id.17   1.384322  35    0 ixcol1:id  17
ixcol1:id.18  -2.066055  29    0 ixcol1:id  18
ixcol1:id.19  -1.257063  44    0 ixcol1:id  19
ixcol1:id.20  -1.435996  36    0 ixcol1:id  20
ixcol1:id.21   0.985629  34    0 ixcol1:id  21
ixcol1:id.22   0.384502  48    0 ixcol1:id  22
ixcol1:id.23   0.277744  32    0 ixcol1:id  23
ixcol1:id.24   0.168753  26    0 ixcol1:id  24
ixcol1:id.25   1.252216  30    0 ixcol1:id  25
ixcol1:id.26  -0.240848  29    0 ixcol1:id  26
ixcol1:id.27  -0.445267  34    0 ixcol1:id  27
ixcol1:id.28   0.377799  16    0 ixcol1:id  28
ixcol1:id.29   0.325144  41    0 ixcol1:id  29
ixcol1:id.30  -0.868818  20    0 ixcol1:id  30
ixcol1:id.31  -0.632995  32    0 ixcol1:id  31
ixcol1:id.32   0.581136  35    0 ixcol1:id  32
ixcol1:id.33  -0.802126  40    0 ixcol1:id  33
ixcol1:id.34  -2.634101  34    0 ixcol1:id  34
ixcol1:id.35  -0.090978  38    0 ixcol1:id  35
ixcol1:id.36   1.309155  29    0 ixcol1:id  36
ixcol1:id.37  -1.421302  36    0 ixcol1:id  37
ixcol1:id.38   0.775525  34    0 ixcol1:id  38
ixcol1:id.39  -0.499267  36    0 ixcol1:id  39
ixcol1:id.40  -1.300163  24    0 ixcol1:id  40
ixcol1:id.41   0.614270  34    0 ixcol1:id  41
ixcol1:id.42   0.785529  29    0 ixcol1:id  42
ixcol1:id.43  -0.064651  23    0 ixcol1:id  43
ixcol1:id.44  -1.126915  28    0 ixcol1:id  44
ixcol1:id.45  -1.550569  38    0 ixcol1:id  45
ixcol1:id.46   0.689908  22    0 ixcol1:id  46
ixcol1:id.47  -1.690858  29    0 ixcol1:id  47
ixcol1:id.48   1.525483  36    0 ixcol1:id  48
ixcol1:id.49   0.419761  46    0 ixcol1:id  49
ixcol1:id.50  -0.825361  36    0 ixcol1:id  50
ixcol1:id.51   0.928722  34    0 ixcol1:id  51
ixcol1:id.52   0.805298  36    0 ixcol1:id  52
ixcol1:id.53  -1.870322  29    0 ixcol1:id  53
ixcol1:id.54  -0.742713  33    0 ixcol1:id  54
ixcol1:id.55  -0.397543  39    0 ixcol1:id  55
ixcol1:id.56   1.644800  34    0 ixcol1:id  56
ixcol1:id.57   1.331069  29    0 ixcol1:id  57
ixcol1:id.58  -1.549414  32    0 ixcol1:id  58
ixcol1:id.59   1.629718  42    0 ixcol1:id  59
ixcol1:id.60  -0.661534  34    0 ixcol1:id  60
ixcol1:id.61   1.389449  33    0 ixcol1:id  61
ixcol1:id.62  -1.875968  26    0 ixcol1:id  62
ixcol1:id.63  -1.173216  44    0 ixcol1:id  63
ixcol1:id.64   0.552054  28    0 ixcol1:id  64
ixcol1:id.65   0.608109  33    0 ixcol1:id  65
ixcol1:id.66   0.738660  22    0 ixcol1:id  66
ixcol1:id.67   0.764002  29    0 ixcol1:id  67
ixcol1:id.68  -0.466533  34    0 ixcol1:id  68
ixcol1:id.69   0.782288  25    0 ixcol1:id  69
ixcol1:id.70   1.174214  33    0 ixcol1:id  70
ixcol1:id.71   0.854083  26    0 ixcol1:id  71
ixcol1:id.72  -0.494332  38    0 ixcol1:id  72
ixcol1:id.73   0.630845  37    0 ixcol1:id  73
ixcol1:id.74   1.767679  35    0 ixcol1:id  74
ixcol1:id.75   1.531064  27    0 ixcol1:id  75
ixcol1:id.76   0.565135  28    0 ixcol1:id  76
ixcol1:id.77   0.251476  22    0 ixcol1:id  77
ixcol1:id.78   2.836329  38    0 ixcol1:id  78
ixcol1:id.79   0.309846  40    0 ixcol1:id  79
ixcol1:id.80   0.743759  38    0 ixcol1:id  80
ixcol1:id.81   0.083617  31    0 ixcol1:id  81
ixcol1:id.82  -0.693073  30    0 ixcol1:id  82
ixcol1:id.83  -0.643657  45    0 ixcol1:id  83
ixcol1:id.84  -0.237093  28    0 ixcol1:id  84
ixcol1:id.85   2.927913  38    0 ixcol1:id  85
ixcol1:id.86  -0.234164  29    0 ixcol1:id  86
ixcol1:id.87   1.244895  38    0 ixcol1:id  87
ixcol1:id.88  -1.086793  34    0 ixcol1:id  88
ixcol1:id.89   0.071545  30    0 ixcol1:id  89
ixcol1:id.90   1.094589  30    0 ixcol1:id  90
ixcol1:id.91   0.992051  29    0 ixcol1:id  91
ixcol1:id.92   2.076102  28    0 ixcol1:id  92
ixcol1:id.93  -1.062898  32    0 ixcol1:id  93
ixcol1:id.94   0.240045  34    0 ixcol1:id  94
ixcol1:id.95  -0.091756  37    0 ixcol1:id  95
ixcol1:id.96  -0.738760  38    0 ixcol1:id  96
ixcol1:id.97   0.645146  31    0 ixcol1:id  97
ixcol1:id.98   0.836123  39    0 ixcol1:id  98
ixcol1:id.99  -1.312696  25    0 ixcol1:id  99
ixcol1:id.100  0.705686  35    0 ixcol1:id 100
ixcol1:id.101  1.266303  27    0 ixcol1:id 101
ixcol1:id.102 -0.037847  25    0 ixcol1:id 102
ixcol1:id.103  0.736350  34    0 ixcol1:id 103
ixcol1:id.104  1.461636  34    0 ixcol1:id 104
ixcol1:id.105 -0.215367  34    0 ixcol1:id 105
ixcol1:id.106 -0.578220  38    0 ixcol1:id 106
ixcol1:id.107  0.297420  36    0 ixcol1:id 107
ixcol1:id.108 -0.246048  40    0 ixcol1:id 108
ixcol1:id.109  0.309082  45    0 ixcol1:id 109
ixcol1:id.110 -1.322226  22    0 ixcol1:id 110
ixcol1:id.111 -0.210227  27    0 ixcol1:id 111
ixcol1:id.112  1.336081  35    0 ixcol1:id 112
ixcol1:id.113  0.901466  45    0 ixcol1:id 113
ixcol1:id.114 -0.531564  32    0 ixcol1:id 114
ixcol1:id.115  1.962684  36    0 ixcol1:id 115
ixcol1:id.116  0.419821  39    0 ixcol1:id 116
ixcol1:id.117  0.739810  35    0 ixcol1:id 117
ixcol1:id.118 -1.283564  31    0 ixcol1:id 118
ixcol1:id.119  0.803188  31    0 ixcol1:id 119
ixcol1:id.120 -0.451912  20    0 ixcol1:id 120
ixcol1:id.121 -0.619946  30    0 ixcol1:id 121
ixcol1:id.122  1.240862  38    0 ixcol1:id 122
ixcol1:id.123  1.601322  29    0 ixcol1:id 123
ixcol1:id.124 -0.261412  32    0 ixcol1:id 124
ixcol1:id.125  1.051639  29    0 ixcol1:id 125
ixcol1:id.126 -0.489980  41    0 ixcol1:id 126
ixcol1:id.127 -0.066138  32    0 ixcol1:id 127
ixcol1:id.128 -0.107077  45    0 ixcol1:id 128
ixcol1:id.129 -0.790887  38    0 ixcol1:id 129
ixcol1:id.130  1.178179  29    0 ixcol1:id 130
ixcol1:id.131  0.747952  32    0 ixcol1:id 131
ixcol1:id.132 -0.123115  31    0 ixcol1:id 132
ixcol1:id.133  0.744477  46    0 ixcol1:id 133
ixcol1:id.134 -1.008280  32    0 ixcol1:id 134
ixcol1:id.135  1.264948  31    0 ixcol1:id 135
ixcol1:id.136  2.098526  36    0 ixcol1:id 136
ixcol1:id.137 -1.206065  28    0 ixcol1:id 137
ixcol1:id.138  1.670985  26    0 ixcol1:id 138
ixcol1:id.139 -2.558401  24    0 ixcol1:id 139
ixcol1:id.140 -0.452918  38    0 ixcol1:id 140
ixcol1:id.141  0.213455  27    0 ixcol1:id 141
ixcol1:id.142 -1.675744  33    0 ixcol1:id 142
ixcol1:id.143  1.720448  34    0 ixcol1:id 143
ixcol1:id.144 -1.167362  30    0 ixcol1:id 144
ixcol1:id.145  1.094602  38    0 ixcol1:id 145
ixcol1:id.146  0.757865  44    0 ixcol1:id 146
ixcol1:id.147 -0.535849  47    0 ixcol1:id 147
ixcol1:id.148  1.618309  30    0 ixcol1:id 148
ixcol1:id.149  0.474393  37    0 ixcol1:id 149
ixcol1:id.150  1.176228  44    0 ixcol1:id 150
ixcol2:id.1   -1.462505  43    0 ixcol2:id   1
ixcol2:id.2   -2.112717  26    0 ixcol2:id   2
ixcol2:id.3   -0.044535  41    0 ixcol2:id   3
ixcol2:id.4   -0.589419  34    0 ixcol2:id   4
ixcol2:id.5   -0.572989  32    0 ixcol2:id   5
ixcol2:id.6   -3.613463  33    0 ixcol2:id   6
ixcol2:id.7    1.946940  31    0 ixcol2:id   7
ixcol2:id.8   -1.726168  37    0 ixcol2:id   8
ixcol2:id.9    0.616268  42    0 ixcol2:id   9
ixcol2:id.10   1.581848  32    0 ixcol2:id  10
ixcol2:id.11   2.209483  29    0 ixcol2:id  11
ixcol2:id.12   0.099229  43    0 ixcol2:id  12
ixcol2:id.13  -1.122027  34    0 ixcol2:id  13
ixcol2:id.14   0.603942  33    0 ixcol2:id  14
ixcol2:id.15   1.053773  34    0 ixcol2:id  15
ixcol2:id.16  -0.587631  27    0 ixcol2:id  16
ixcol2:id.17   0.829150  35    0 ixcol2:id  17
ixcol2:id.18  -2.516930  29    0 ixcol2:id  18
ixcol2:id.19   0.246738  44    0 ixcol2:id  19
ixcol2:id.20  -1.285533  36    0 ixcol2:id  20
ixcol2:id.21   0.948072  34    0 ixcol2:id  21
ixcol2:id.22   1.865945  48    0 ixcol2:id  22
ixcol2:id.23  -1.072497  32    0 ixcol2:id  23
ixcol2:id.24   0.524333  26    0 ixcol2:id  24
ixcol2:id.25   1.826844  30    0 ixcol2:id  25
ixcol2:id.26   0.034977  29    0 ixcol2:id  26
ixcol2:id.27  -1.853236  34    0 ixcol2:id  27
ixcol2:id.28   0.837561  16    0 ixcol2:id  28
ixcol2:id.29  -0.272988  41    0 ixcol2:id  29
ixcol2:id.30  -0.785545  20    0 ixcol2:id  30
ixcol2:id.31   0.146639  32    0 ixcol2:id  31
ixcol2:id.32   0.253055  35    0 ixcol2:id  32
ixcol2:id.33  -0.785593  40    0 ixcol2:id  33
ixcol2:id.34  -2.729924  34    0 ixcol2:id  34
ixcol2:id.35   0.062323  38    0 ixcol2:id  35
ixcol2:id.36   1.592157  29    0 ixcol2:id  36
ixcol2:id.37  -1.524155  36    0 ixcol2:id  37
ixcol2:id.38   0.561439  34    0 ixcol2:id  38
ixcol2:id.39   0.131190  36    0 ixcol2:id  39
ixcol2:id.40  -0.246323  24    0 ixcol2:id  40
ixcol2:id.41   0.760097  34    0 ixcol2:id  41
ixcol2:id.42   1.422641  29    0 ixcol2:id  42
ixcol2:id.43  -0.194649  23    0 ixcol2:id  43
ixcol2:id.44  -0.773209  28    0 ixcol2:id  44
ixcol2:id.45  -1.260512  38    0 ixcol2:id  45
ixcol2:id.46   0.637040  22    0 ixcol2:id  46
ixcol2:id.47  -1.122447  29    0 ixcol2:id  47
ixcol2:id.48   1.346883  36    0 ixcol2:id  48
ixcol2:id.49   0.458746  46    0 ixcol2:id  49
ixcol2:id.50  -0.069954  36    0 ixcol2:id  50
ixcol2:id.51   0.749606  34    0 ixcol2:id  51
ixcol2:id.52   0.527696  36    0 ixcol2:id  52
ixcol2:id.53  -1.113549  29    0 ixcol2:id  53
ixcol2:id.54  -0.269734  33    0 ixcol2:id  54
ixcol2:id.55  -0.400683  39    0 ixcol2:id  55
ixcol2:id.56   1.430494  34    0 ixcol2:id  56
ixcol2:id.57   1.337136  29    0 ixcol2:id  57
ixcol2:id.58  -1.343019  32    0 ixcol2:id  58
ixcol2:id.59   2.194993  42    0 ixcol2:id  59
ixcol2:id.60  -0.411026  34    0 ixcol2:id  60
ixcol2:id.61   1.039077  33    0 ixcol2:id  61
ixcol2:id.62  -1.063391  26    0 ixcol2:id  62
ixcol2:id.63  -1.398035  44    0 ixcol2:id  63
ixcol2:id.64   0.494153  28    0 ixcol2:id  64
ixcol2:id.65   1.215065  33    0 ixcol2:id  65
ixcol2:id.66   1.183463  22    0 ixcol2:id  66
ixcol2:id.67   0.951244  29    0 ixcol2:id  67
ixcol2:id.68  -1.343681  34    0 ixcol2:id  68
ixcol2:id.69   0.596556  25    0 ixcol2:id  69
ixcol2:id.70   1.028917  33    0 ixcol2:id  70
ixcol2:id.71   0.645242  26    0 ixcol2:id  71
ixcol2:id.72  -0.422711  38    0 ixcol2:id  72
ixcol2:id.73   1.277231  37    0 ixcol2:id  73
ixcol2:id.74   1.501640  35    0 ixcol2:id  74
ixcol2:id.75   1.258249  27    0 ixcol2:id  75
ixcol2:id.76   0.380182  28    0 ixcol2:id  76
ixcol2:id.77  -0.058037  22    0 ixcol2:id  77
ixcol2:id.78   3.123950  38    0 ixcol2:id  78
ixcol2:id.79   0.731295  40    0 ixcol2:id  79
ixcol2:id.80   0.070193  38    0 ixcol2:id  80
ixcol2:id.81   0.794892  31    0 ixcol2:id  81
ixcol2:id.82  -0.148827  30    0 ixcol2:id  82
ixcol2:id.83  -0.567991  45    0 ixcol2:id  83
ixcol2:id.84   0.064953  28    0 ixcol2:id  84
ixcol2:id.85   2.838853  38    0 ixcol2:id  85
ixcol2:id.86  -1.075458  29    0 ixcol2:id  86
ixcol2:id.87   1.278374  38    0 ixcol2:id  87
ixcol2:id.88  -0.916025  34    0 ixcol2:id  88
ixcol2:id.89   0.180182  30    0 ixcol2:id  89
ixcol2:id.90   0.527002  30    0 ixcol2:id  90
ixcol2:id.91   1.279256  29    0 ixcol2:id  91
ixcol2:id.92   2.346137  28    0 ixcol2:id  92
ixcol2:id.93  -1.621061  32    0 ixcol2:id  93
ixcol2:id.94  -0.311579  34    0 ixcol2:id  94
ixcol2:id.95   0.114484  37    0 ixcol2:id  95
ixcol2:id.96  -0.836855  38    0 ixcol2:id  96
ixcol2:id.97   0.706180  31    0 ixcol2:id  97
ixcol2:id.98   0.619699  39    0 ixcol2:id  98
ixcol2:id.99  -0.338962  25    0 ixcol2:id  99
ixcol2:id.100  0.643152  35    0 ixcol2:id 100
ixcol2:id.101  1.001009  27    0 ixcol2:id 101
ixcol2:id.102  0.674016  25    0 ixcol2:id 102
ixcol2:id.103  0.678105  34    0 ixcol2:id 103
ixcol2:id.104  1.512042  34    0 ixcol2:id 104
ixcol2:id.105 -0.409545  34    0 ixcol2:id 105
ixcol2:id.106 -0.948718  38    0 ixcol2:id 106
ixcol2:id.107 -0.027741  36    0 ixcol2:id 107
ixcol2:id.108 -0.457974  40    0 ixcol2:id 108
ixcol2:id.109  0.131416  45    0 ixcol2:id 109
ixcol2:id.110 -1.352217  22    0 ixcol2:id 110
ixcol2:id.111  0.520935  27    0 ixcol2:id 111
ixcol2:id.112  1.657028  35    0 ixcol2:id 112
ixcol2:id.113  1.147788  45    0 ixcol2:id 113
ixcol2:id.114 -0.346719  32    0 ixcol2:id 114
ixcol2:id.115  1.636050  36    0 ixcol2:id 115
ixcol2:id.116  0.771600  39    0 ixcol2:id 116
ixcol2:id.117  0.566431  35    0 ixcol2:id 117
ixcol2:id.118 -1.022224  31    0 ixcol2:id 118
ixcol2:id.119  0.812535  31    0 ixcol2:id 119
ixcol2:id.120 -0.419527  20    0 ixcol2:id 120
ixcol2:id.121 -0.382407  30    0 ixcol2:id 121
ixcol2:id.122  1.371062  38    0 ixcol2:id 122
ixcol2:id.123  1.082821  29    0 ixcol2:id 123
ixcol2:id.124 -0.507895  32    0 ixcol2:id 124
ixcol2:id.125  0.977211  29    0 ixcol2:id 125
ixcol2:id.126 -0.146937  41    0 ixcol2:id 126
ixcol2:id.127  0.098632  32    0 ixcol2:id 127
ixcol2:id.128  0.021990  45    0 ixcol2:id 128
ixcol2:id.129 -0.719647  38    0 ixcol2:id 129
ixcol2:id.130  1.564049  29    0 ixcol2:id 130
ixcol2:id.131  0.328814  32    0 ixcol2:id 131
ixcol2:id.132 -0.301431  31    0 ixcol2:id 132
ixcol2:id.133  0.654875  46    0 ixcol2:id 133
ixcol2:id.134 -1.075699  32    0 ixcol2:id 134
ixcol2:id.135  1.210246  31    0 ixcol2:id 135
ixcol2:id.136  1.749317  36    0 ixcol2:id 136
ixcol2:id.137 -1.076891  28    0 ixcol2:id 137
ixcol2:id.138  1.877528  26    0 ixcol2:id 138
ixcol2:id.139 -3.256554  24    0 ixcol2:id 139
ixcol2:id.140 -0.571645  38    0 ixcol2:id 140
ixcol2:id.141  0.622450  27    0 ixcol2:id 141
ixcol2:id.142 -1.531637  33    0 ixcol2:id 142
ixcol2:id.143  1.903170  34    0 ixcol2:id 143
ixcol2:id.144 -0.788188  30    0 ixcol2:id 144
ixcol2:id.145  1.494509  38    0 ixcol2:id 145
ixcol2:id.146  0.480551  44    0 ixcol2:id 146
ixcol2:id.147 -1.027117  47    0 ixcol2:id 147
ixcol2:id.148  1.860213  30    0 ixcol2:id 148
ixcol2:id.149  0.495415  37    0 ixcol2:id 149
ixcol2:id.150  1.328941  44    0 ixcol2:id 150
id.1           1.471793  43    1        id   1
id.2          -1.002815  26    1        id   2
id.3           0.804958  41    1        id   3
id.4           1.763587  34    1        id   4
id.5           0.186519  32    1        id   5
id.6          -2.109014  33    1        id   6
id.7           2.229363  31    1        id   7
id.8          -1.447391  37    1        id   8
id.9           1.592504  42    1        id   9
id.10          1.254944  32    1        id  10
id.11          2.134963  29    1        id  11
id.12          0.997045  43    1        id  12
id.13         -0.189838  34    1        id  13
id.14          0.731345  33    1        id  14
id.15          2.353206  34    1        id  15
id.16          0.015780  27    1        id  16
id.17          2.333200  35    1        id  17
id.18         -1.320305  29    1        id  18
id.19         -0.108182  44    1        id  19
id.20         -0.619745  36    1        id  20
id.21          1.276246  34    1        id  21
id.22          1.177861  48    1        id  22
id.23          0.570870  32    1        id  23
id.24          0.682748  26    1        id  24
id.25          2.356633  30    1        id  25
id.26          0.210256  29    1        id  26
id.27          0.124522  34    1        id  27
id.28          1.145511  16    1        id  28
id.29          0.542076  41    1        id  29
id.30         -0.154420  20    1        id  30
id.31          0.529509  32    1        id  31
id.32          0.527831  35    1        id  32
id.33         -0.615344  40    1        id  33
id.34         -0.929703  34    1        id  34
id.35          0.187573  38    1        id  35
id.36          1.992183  29    1        id  36
id.37         -0.479610  36    1        id  37
id.38          1.548419  34    1        id  38
id.39          0.671511  36    1        id  39
id.40         -0.233498  24    1        id  40
id.41          1.548505  34    1        id  41
id.42          1.609942  29    1        id  42
id.43          0.486787  23    1        id  43
id.44          0.099697  28    1        id  44
id.45         -0.344528  38    1        id  45
id.46          0.991705  22    1        id  46
id.47         -0.328853  29    1        id  47
id.48          2.217765  36    1        id  48
id.49          0.990717  46    1        id  49
id.50         -0.083580  36    1        id  50
id.51          1.298578  34    1        id  51
id.52          0.835586  36    1        id  52
id.53         -0.880613  29    1        id  53
id.54          0.271103  33    1        id  54
id.55         -0.079529  39    1        id  55
id.56          1.835414  34    1        id  56
id.57          1.780595  29    1        id  57
id.58         -0.957488  32    1        id  58
id.59          2.008506  42    1        id  59
id.60          0.141771  34    1        id  60
id.61          1.130892  33    1        id  61
id.62         -1.203278  26    1        id  62
id.63         -0.715865  44    1        id  63
id.64          0.894281  28    1        id  64
id.65          1.105985  33    1        id  65
id.66          1.242725  22    1        id  66
id.67          1.357942  29    1        id  67
id.68         -0.582821  34    1        id  68
id.69          1.229078  25    1        id  69
id.70          2.011814  33    1        id  70
id.71          1.144205  26    1        id  71
id.72          0.241048  38    1        id  72
id.73          1.448289  37    1        id  73
id.74          2.360954  35    1        id  74
id.75          2.164186  27    1        id  75
id.76          1.050516  28    1        id  76
id.77          1.010743  22    1        id  77
id.78          3.388519  38    1        id  78
id.79          1.387731  40    1        id  79
id.80          0.622700  38    1        id  80
id.81          1.137138  31    1        id  81
id.82         -0.016471  30    1        id  82
id.83          0.059992  45    1        id  83
id.84          0.775499  28    1        id  84
id.85          3.440572  38    1        id  85
id.86         -0.055907  29    1        id  86
id.87          1.566238  38    1        id  87
id.88         -0.551831  34    1        id  88
id.89          0.822730  30    1        id  89
id.90          1.699233  30    1        id  90
id.91          1.701019  29    1        id  91
id.92          3.095488  28    1        id  92
id.93         -0.979983  32    1        id  93
id.94          0.503211  34    1        id  94
id.95          0.365196  37    1        id  95
id.96         -0.282213  38    1        id  96
id.97          1.009189  31    1        id  97
id.98          1.129940  39    1        id  98
id.99         -0.344775  25    1        id  99
id.100         1.185793  35    1        id 100
id.101         1.850578  27    1        id 101
id.102         0.528580  25    1        id 102
id.103         1.370648  34    1        id 103
id.104         2.034057  34    1        id 104
id.105         0.187402  34    1        id 105
id.106         0.436163  38    1        id 106
id.107         0.444527  36    1        id 107
id.108         0.611228  40    1        id 108
id.109         0.743305  45    1        id 109
id.110        -1.067512  22    1        id 110
id.111         0.713703  27    1        id 111
id.112         2.484097  35    1        id 112
id.113         1.808742  45    1        id 113
id.114         0.193403  32    1        id 114
id.115         2.525829  36    1        id 115
id.116         1.106579  39    1        id 116
id.117         1.460747  35    1        id 117
id.118        -0.814131  31    1        id 118
id.119         1.566731  31    1        id 119
id.120         0.018845  20    1        id 120
id.121         0.152569  30    1        id 121
id.122         1.826103  38    1        id 122
id.123         1.751739  29    1        id 123
id.124         0.246218  32    1        id 124
id.125         1.571847  29    1        id 125
id.126         0.357764  41    1        id 126
id.127         0.550519  32    1        id 127
id.128         0.455358  45    1        id 128
id.129         0.152751  38    1        id 129
id.130         1.947220  29    1        id 130
id.131         1.146742  32    1        id 131
id.132         0.492116  31    1        id 132
id.133         1.449076  46    1        id 133
id.134        -0.429782  32    1        id 134
id.135         1.725338  31    1        id 135
id.136         2.332858  36    1        id 136
id.137        -0.582218  28    1        id 137
id.138         1.605602  26    1        id 138
id.139        -2.172535  24    1        id 139
id.140        -0.091922  38    1        id 140
id.141         0.983423  27    1        id 141
id.142        -1.150570  33    1        id 142
id.143         2.193888  34    1        id 143
id.144        -0.237179  30    1        id 144
id.145         1.720239  38    1        id 145
id.146         1.103430  44    1        id 146
id.147        -0.165679  47    1        id 147
id.148         2.505542  30    1        id 148
id.149         0.988400  37    1        id 149
id.150         2.128416  44    1        id 150
fx:firm.1     -0.599737  33    0   fx:firm   1
fx:firm.2      1.653665  33    0   fx:firm   2
fx:firm.3     -0.890265  47    0   fx:firm   3
fx:firm.4      1.798253  33    0   fx:firm   4
fx:firm.5     -0.008032  41    0   fx:firm   5
fx:firm.6     -0.301977  33    0   fx:firm   6
fx:firm.7     -0.909853  53    0   fx:firm   7
fx:firm.8      0.613636  48    0   fx:firm   8
fx:firm.9     -0.174380  29    0   fx:firm   9
fx:firm.10     0.197273  34    0   fx:firm  10
fx:firm.11     0.502587  30    0   fx:firm  11
fx:firm.12     0.732179  37    0   fx:firm  12
fx:firm.13    -0.464212  41    0   fx:firm  13
fx:firm.14     1.334730  42    0   fx:firm  14
fx:firm.15     0.141168  29    0   fx:firm  15
fx:firm.16     1.210487  49    0   fx:firm  16
fx:firm.17    -1.506446  48    0   fx:firm  17
fx:firm.18     1.081476  49    0   fx:firm  18
fx:firm.19    -1.891080  37    0   fx:firm  19
fx:firm.20     0.977508  34    0   fx:firm  20
fx:firm.21    -0.094912  36    0   fx:firm  21
fx:firm.22    -0.534362  42    0   fx:firm  22
fx:firm.23    -0.217427  39    0   fx:firm  23
fx:firm.24     0.046722  49    0   fx:firm  24
fx:firm.25     0.185837  28    0   fx:firm  25
fx:firm.26    -1.024314  39    0   fx:firm  26
fx:firm.27    -1.509631  30    0   fx:firm  27
fx:firm.28    -0.550817  41    0   fx:firm  28
fx:firm.29    -1.123331  38    0   fx:firm  29
fx:firm.30     0.433778  41    0   fx:firm  30
fx:firm.31    -0.312311  41    0   fx:firm  31
fx:firm.32    -0.279463  35    0   fx:firm  32
fx:firm.33    -0.343216  38    0   fx:firm  33
fx:firm.34    -0.694730  38    0   fx:firm  34
fx:firm.35     0.584030  29    0   fx:firm  35
fx:firm.36    -0.189953  31    0   fx:firm  36
fx:firm.37    -0.656013  46    0   fx:firm  37
fx:firm.38    -0.266290  50    0   fx:firm  38
fx:firm.39     1.469248  43    0   fx:firm  39
fx:firm.40     1.235216  34    0   fx:firm  40
fx:firm.41    -0.324612  30    0   fx:firm  41
fx:firm.42    -0.618150  32    0   fx:firm  42
fx:firm.43     1.008699  38    0   fx:firm  43
fx:firm.44    -0.103326  36    0   fx:firm  44
fx:firm.45    -1.199736  45    0   fx:firm  45
fx:firm.46     0.906271  39    0   fx:firm  46
fx:firm.47     0.566817  41    0   fx:firm  47
fx:firm.48    -0.647548  34    0   fx:firm  48
fx:firm.49    -2.151289  28    0   fx:firm  49
fx:firm.50     0.978937  36    0   fx:firm  50
fx:firm.51    -0.927242  49    0   fx:firm  51
fx:firm.52    -1.638717  36    0   fx:firm  52
fx:firm.53     1.715262  35    0   fx:firm  53
fx:firm.54    -2.337266  32    0   fx:firm  54
fx:firm.55     1.344484  29    0   fx:firm  55
fx:firm.56     0.339635  42    0   fx:firm  56
fx:firm.57     0.151360  30    0   fx:firm  57
fx:firm.58    -0.049489  34    0   fx:firm  58
fx:firm.59    -0.841235  41    0   fx:firm  59
fx:firm.60    -0.572980  42    0   fx:firm  60
fx:firm.61     0.436159  53    0   fx:firm  61
fx:firm.62     0.394647  37    0   fx:firm  62
fx:firm.63     0.760654  37    0   fx:firm  63
fx:firm.64    -0.183776  38    0   fx:firm  64
fx:firm.65     0.041939  41    0   fx:firm  65
fx:firm.66     1.511092  39    0   fx:firm  66
fx:firm.67     0.376348  33    0   fx:firm  67
fx:firm.68     0.890577  42    0   fx:firm  68
fx:firm.69    -0.931113  42    0   fx:firm  69
fx:firm.70     0.664244  42    0   fx:firm  70
fx:firm.71     0.594512  26    0   fx:firm  71
fx:firm.72     0.830938  40    0   fx:firm  72
fx:firm.73    -0.102481  39    0   fx:firm  73
fx:firm.74     1.641088  56    0   fx:firm  74
fx:firm.75    -1.292589  38    0   fx:firm  75
fx:firm.76    -0.789394  48    0   fx:firm  76
fx:firm.77    -0.711027  35    0   fx:firm  77
fx:firm.78     1.290200  32    0   fx:firm  78
fx:firm.79    -0.063543  32    0   fx:firm  79
fx:firm.80    -2.206856  44    0   fx:firm  80
fx:firm.81    -1.472973  36    0   fx:firm  81
fx:firm.82    -0.287417  32    0   fx:firm  82
fx:firm.83     0.793116  55    0   fx:firm  83
fx:firm.84     0.086607  37    0   fx:firm  84
fx:firm.85    -0.470828  33    0   fx:firm  85
fx:firm.86    -0.343811  36    0   fx:firm  86
fx:firm.87    -2.815803  36    0   fx:firm  87
fx:firm.88    -0.166511  35    0   fx:firm  88
fx:firm.89    -0.439393  39    0   fx:firm  89
fx:firm.90    -0.546016  26    0   fx:firm  90
fx:firm.91    -1.312697  37    0   fx:firm  91
fx:firm.92     0.499094  31    0   fx:firm  92
fx:firm.93     1.036396  47    0   fx:firm  93
fx:firm.94    -1.409671  50    0   fx:firm  94
fx:firm.95     0.327006  39    0   fx:firm  95
fx:firm.96     0.323317  52    0   fx:firm  96
fx:firm.97    -0.203126  31    0   fx:firm  97
fx:firm.98     0.959628  37    0   fx:firm  98
fx:firm.99    -0.260603  43    0   fx:firm  99
fx:firm.100   -0.982252  33    0   fx:firm 100
fx:firm.101    0.358606  40    0   fx:firm 101
fx:firm.102   -0.662821  36    0   fx:firm 102
fx:firm.103    1.671603  39    0   fx:firm 103
fx:firm.104    1.730292  41    0   fx:firm 104
fx:firm.105   -0.712516  31    0   fx:firm 105
fx:firm.106    0.898471  23    0   fx:firm 106
fx:firm.107    1.301166  43    0   fx:firm 107
fx:firm.108    1.415351  30    0   fx:firm 108
fx:firm.109   -3.059663  46    0   fx:firm 109
fx:firm.110    0.249982  34    0   fx:firm 110
fx:firm.111    0.740845  32    0   fx:firm 111
fx:firm.112    0.827833  52    0   fx:firm 112
fx:firm.113   -0.590837  35    0   fx:firm 113
fx:firm.114    0.131917  34    0   fx:firm 114
fx:firm.115    0.093018  49    0   fx:firm 115
fx:firm.116   -0.628028  42    0   fx:firm 116
fx:firm.117    0.538125  42    0   fx:firm 117
fx:firm.118   -0.504918  41    0   fx:firm 118
fx:firm.119   -1.088605  32    0   fx:firm 119
fx:firm.120   -1.056392  35    0   fx:firm 120
fx:firm.121    0.467953  45    0   fx:firm 121
fx:firm.122   -0.293957  34    0   fx:firm 122
fx:firm.123   -1.050497  34    0   fx:firm 123
fx:firm.124    0.996361  39    0   fx:firm 124
fx:firm.125   -0.880027  42    0   fx:firm 125
fx:firm.126    0.850598  36    0   fx:firm 126
fx:firm.127    0.729367  35    0   fx:firm 127
fx:firm.128   -0.873073  48    0   fx:firm 128
fx:firm.129    2.559719  43    0   fx:firm 129
fx:firm.130    0.223796  51    0   fx:firm 130
firm.1        -2.198217  33    1      firm   1
firm.2        -0.172797  33    1      firm   2
firm.3        -2.642974  47    1      firm   3
firm.4         0.237263  33    1      firm   4
firm.5        -1.349062  41    1      firm   5
firm.6        -2.103945  33    1      firm   6
firm.7        -2.075229  53    1      firm   7
firm.8        -1.045784  48    1      firm   8
firm.9        -1.522049  29    1      firm   9
firm.10       -0.913812  34    1      firm  10
firm.11       -0.889627  30    1      firm  11
firm.12       -0.952771  37    1      firm  12
firm.13       -1.884712  41    1      firm  13
firm.14       -0.805850  42    1      firm  14
firm.15       -1.259839  29    1      firm  15
firm.16       -0.816113  49    1      firm  16
firm.17       -3.194574  48    1      firm  17
firm.18       -0.340701  49    1      firm  18
firm.19       -3.262556  37    1      firm  19
firm.20       -0.512204  34    1      firm  20
firm.21       -1.262761  36    1      firm  21
firm.22       -2.586101  42    1      firm  22
firm.23       -1.976506  39    1      firm  23
firm.24       -1.636415  49    1      firm  24
firm.25       -1.231884  28    1      firm  25
firm.26       -2.562543  39    1      firm  26
firm.27       -2.565764  30    1      firm  27
firm.28       -2.287783  41    1      firm  28
firm.29       -2.777031  38    1      firm  29
firm.30       -1.073702  41    1      firm  30
firm.31       -2.070273  41    1      firm  31
firm.32       -2.435667  35    1      firm  32
firm.33       -2.198209  38    1      firm  33
firm.34       -2.555025  38    1      firm  34
firm.35       -0.874793  29    1      firm  35
firm.36       -1.379327  31    1      firm  36
firm.37       -2.142340  46    1      firm  37
firm.38       -1.770343  50    1      firm  38
firm.39       -0.105138  43    1      firm  39
firm.40       -0.263725  34    1      firm  40
firm.41       -2.336245  30    1      firm  41
firm.42       -1.841920  32    1      firm  42
firm.43       -0.284812  38    1      firm  43
firm.44       -1.362139  36    1      firm  44
firm.45       -2.627539  45    1      firm  45
firm.46       -0.538803  39    1      firm  46
firm.47       -1.605775  41    1      firm  47
firm.48       -2.338728  34    1      firm  48
firm.49       -3.585969  28    1      firm  49
firm.50       -1.074500  36    1      firm  50
firm.51       -2.535393  49    1      firm  51
firm.52       -3.217733  36    1      firm  52
firm.53       -0.235278  35    1      firm  53
firm.54       -4.140754  32    1      firm  54
firm.55       -0.428643  29    1      firm  55
firm.56       -1.327231  42    1      firm  56
firm.57       -0.920426  30    1      firm  57
firm.58       -1.325081  34    1      firm  58
firm.59       -2.336773  41    1      firm  59
firm.60       -1.640192  42    1      firm  60
firm.61       -1.389615  53    1      firm  61
firm.62       -0.788773  37    1      firm  62
firm.63       -1.019773  37    1      firm  63
firm.64       -1.997042  38    1      firm  64
firm.65       -1.381095  41    1      firm  65
firm.66       -0.295792  39    1      firm  66
firm.67       -1.989217  33    1      firm  67
firm.68       -0.935689  42    1      firm  68
firm.69       -2.505751  42    1      firm  69
firm.70       -1.334561  42    1      firm  70
firm.71       -1.751430  26    1      firm  71
firm.72       -0.954537  40    1      firm  72
firm.73       -2.016693  39    1      firm  73
firm.74        0.000000  56    1      firm  74
firm.75       -3.087275  38    1      firm  75
firm.76       -2.181647  48    1      firm  76
firm.77       -2.520611  35    1      firm  77
firm.78       -0.526117  32    1      firm  78
firm.79       -2.540983  32    1      firm  79
firm.80       -3.419287  44    1      firm  80
firm.81       -2.536041  36    1      firm  81
firm.82       -2.003197  32    1      firm  82
firm.83       -0.753822  55    1      firm  83
firm.84       -1.659231  37    1      firm  84
firm.85       -2.026170  33    1      firm  85
firm.86       -2.693061  36    1      firm  86
firm.87       -4.369713  36    1      firm  87
firm.88       -2.045573  35    1      firm  88
firm.89       -2.057318  39    1      firm  89
firm.90       -1.956061  26    1      firm  90
firm.91       -2.733668  37    1      firm  91
firm.92       -1.377475  31    1      firm  92
firm.93       -0.392927  47    1      firm  93
firm.94       -2.931089  50    1      firm  94
firm.95       -1.366398  39    1      firm  95
firm.96       -1.418882  52    1      firm  96
firm.97       -1.951372  31    1      firm  97
firm.98       -0.682065  37    1      firm  98
firm.99       -1.932581  43    1      firm  99
firm.100      -3.270866  33    1      firm 100
firm.101      -1.413265  40    1      firm 101
firm.102      -2.785506  36    1      firm 102
firm.103      -0.268824  39    1      firm 103
firm.104       0.308340  41    1      firm 104
firm.105      -2.171928  31    1      firm 105
firm.106      -1.148279  23    1      firm 106
firm.107      -0.585221  43    1      firm 107
firm.108      -0.805278  30    1      firm 108
firm.109      -4.671702  46    1      firm 109
firm.110      -1.493804  34    1      firm 110
firm.111      -1.087217  32    1      firm 111
firm.112      -0.940457  52    1      firm 112
firm.113      -2.127822  35    1      firm 113
firm.114      -1.447093  34    1      firm 114
firm.115      -1.435841  49    1      firm 115
firm.116      -1.647014  42    1      firm 116
firm.117      -1.272842  42    1      firm 117
firm.118      -1.971006  41    1      firm 118
firm.119      -2.904627  32    1      firm 119
firm.120      -2.761151  35    1      firm 120
firm.121      -1.097438  45    1      firm 121
firm.122      -1.939292  34    1      firm 122
firm.123      -2.797274  34    1      firm 123
firm.124      -0.616987  39    1      firm 124
firm.125      -2.350600  42    1      firm 125
firm.126      -1.267860  36    1      firm 126
firm.127      -1.025733  35    1      firm 127
firm.128      -2.719625  48    1      firm 128
firm.129       0.738116  43    1      firm 129
firm.130      -1.284902  51    1      firm 130
shoe.1        -0.055474 519    2      shoe   1
shoe.2        -1.054902 484    2      shoe   2
shoe.3         0.090528 481    2      shoe   3
shoe.4        -0.470101 490    2      shoe   4
shoe.5         0.000000 522    2      shoe   5
shoe.6         0.322138 517    2      shoe   6
shoe.7         0.765464 477    2      shoe   7
shoe.8         0.412225 501    2      shoe   8
shoe.9         2.019279 505    2      shoe   9
shoe.10        1.135720 504    2      shoe  10
shirt.1        1.396919 519    3     shirt   1
shirt.2        2.446112 500    3     shirt   2
shirt.3        1.849636 478    3     shirt   3
shirt.4        1.909517 495    3     shirt   4
shirt.5        1.978282 475    3     shirt   5
shirt.6        2.333216 477    3     shirt   6
shirt.7        2.431415 489    3     shirt   7
shirt.8        0.000000 536    3     shirt   8
shirt.9       -1.768959 514    3     shirt   9
shirt.10       1.749935 517    3     shirt  10
> 
> # make sure this one works, 
> summary(est <- felm(y ~ x | x2:id + x3:id + id))

Call:
   felm(formula = y ~ x | x2:id + x3:id + id) 

Residuals:
     Min       1Q   Median       3Q      Max 
-11.3772  -1.3948   0.0998   1.5098  13.5348 

Coefficients:
  Estimate Std. Error t value Pr(>|t|)    
x   1.0579     0.0357    29.6   <2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 2.43 on 4549 degrees of freedom
Multiple R-squared: 0.361   Adjusted R-squared: 0.297 
F-statistic:5.71 on 450 and 4549 DF, p-value: <2e-16 
*** Standard errors may be too high due to more than 2 groups and exactDOF=FALSE


> 
> 
> # compare with lm
> x <- rnorm(100)
> id <- factor(sample(5,length(x), replace=T))
> id.eff <- rnorm(nlevels(id))
> firm.eff <- rnorm(nlevels(firm))
> firm <- factor(sample(7,length(x), replace=T))
> fx <- rnorm(length(x))
> ix <- matrix(rnorm(2*length(x)),length(x),2)
> y <- x + rowSums(ix*id.eff[id]) + fx*firm.eff[firm] + firm.eff[firm] + rnorm(length(x))
> summary(est <- felm(y ~ x | ix:id + fx:firm + firm, exactDOF='rM'))

Call:
   felm(formula = y ~ x | ix:id + fx:firm + firm, exactDOF = "rM") 

Residuals:
    Min      1Q  Median      3Q     Max 
-3.4750 -0.6373  0.0412  0.5788  2.2730 

Coefficients:
  Estimate Std. Error t value Pr(>|t|)    
x     0.83       0.11    7.56  8.3e-11 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.04 on 75 degrees of freedom
Multiple R-squared: 0.844   Adjusted R-squared: 0.793 
F-statistic:  17 on 24 and 75 DF, p-value: <2e-16 


> getfe(est)
           effect obs comp      fe idx
ix1:id.1   1.6823  17    0  ix1:id   1
ix1:id.2   0.5920  25    0  ix1:id   2
ix1:id.3  -0.6409  18    0  ix1:id   3
ix1:id.4   0.5258  15    0  ix1:id   4
ix1:id.5   1.3744  25    0  ix1:id   5
ix2:id.1   1.8356  17    0  ix2:id   1
ix2:id.2   0.5209  25    0  ix2:id   2
ix2:id.3  -0.4600  18    0  ix2:id   3
ix2:id.4   1.3243  15    0  ix2:id   4
ix2:id.5   0.6617  25    0  ix2:id   5
fx:firm.1  0.3984  10    0 fx:firm   1
fx:firm.2  0.4428  10    0 fx:firm   2
fx:firm.3  1.0070  21    0 fx:firm   3
fx:firm.4  0.4967  18    0 fx:firm   4
fx:firm.5 -0.3137  14    0 fx:firm   5
fx:firm.6  0.6247  15    0 fx:firm   6
fx:firm.7 -1.5031  12    0 fx:firm   7
firm.1     0.5103  10    1    firm   1
firm.2     0.7592  10    1    firm   2
firm.3     0.8699  21    1    firm   3
firm.4     0.8645  18    1    firm   4
firm.5     0.5642  14    1    firm   5
firm.6     0.4175  15    1    firm   6
firm.7    -0.9494  12    1    firm   7
> summary(lm(y ~ x + ix:id + fx:firm + firm))

Call:
lm(formula = y ~ x + ix:id + fx:firm + firm)

Residuals:
   Min     1Q Median     3Q    Max 
-3.475 -0.637  0.041  0.579  2.273 

Coefficients:
            Estimate Std. Error t value Pr(>|t|)    
(Intercept)   0.5103     0.3534    1.44  0.15296    
x             0.8301     0.1099    7.56  8.3e-11 ***
firm2         0.2489     0.5391    0.46  0.64565    
firm3         0.3596     0.4436    0.81  0.42014    
firm4         0.3542     0.4374    0.81  0.42059    
firm5         0.0539     0.5203    0.10  0.91781    
firm6        -0.0927     0.4630   -0.20  0.84176    
firm7        -1.4597     0.4913   -2.97  0.00398 ** 
ix1:id1       1.6823     0.3380    4.98  4.0e-06 ***
ix2:id1       1.8356     0.2891    6.35  1.5e-08 ***
ix1:id2       0.5920     0.2371    2.50  0.01471 *  
ix2:id2       0.5209     0.2436    2.14  0.03574 *  
ix1:id3      -0.6409     0.2577   -2.49  0.01511 *  
ix2:id3      -0.4600     0.2819   -1.63  0.10692    
ix1:id4       0.5258     0.3356    1.57  0.12143    
ix2:id4       1.3243     0.2885    4.59  1.7e-05 ***
ix1:id5       1.3744     0.1931    7.12  5.6e-10 ***
ix2:id5       0.6617     0.2173    3.05  0.00321 ** 
fx:firm1      0.3984     0.4293    0.93  0.35637    
fx:firm2      0.4428     0.4352    1.02  0.31219    
fx:firm3      1.0070     0.2603    3.87  0.00023 ***
fx:firm4      0.4967     0.2784    1.78  0.07844 .  
fx:firm5     -0.3137     0.3569   -0.88  0.38228    
fx:firm6      0.6247     0.3195    1.96  0.05430 .  
fx:firm7     -1.5031     0.3538   -4.25  6.1e-05 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.04 on 75 degrees of freedom
Multiple R-squared:  0.844,	Adjusted R-squared:  0.795 
F-statistic:   17 on 24 and 75 DF,  p-value: <2e-16

> 
> 
> proc.time()
   user  system elapsed 
  6.378   0.128   5.902 
